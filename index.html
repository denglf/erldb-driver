<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Erldb by denglf</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Erldb</h1>
        <h2>Linked-in driver of erlang that supports popular RDMBS like mysql, oracle, DB2 and sybase.</h2>
        <a href="https://github.com/denglf/erldb-driver" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h2>
<a name="introduction" class="anchor" href="#introduction"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>The db_driver is a high performance database driver based on the Erlang linked-in driver. It uses asynchronous threads to avoid IO block during the database access, the same way in which Erlang asynchronous drivers were implemented. We followed the syntax of Erlydb (erlang_mysql_driver) to design the APIs. For one database access request, the parameters will be passed to driver and processed in asynchronous threads. Then the request will be translated to respective SQL statements for different database types. After that, the work threads will call vendors' C/C++ APIs to execute these SQL statements and return the responses with ei.</p>

<p>Now the driver supports MySQL, Oracle, Sybase, DB2 and Informix.</p>

<h2>
<a name="design-purpose" class="anchor" href="#design-purpose"><span class="octicon octicon-link"></span></a>Design Purpose</h2>

<p>We want to support most typical database systems, such as Mysql, Oracle, Sybase, DB2 and Informix, but we don't choose ODBC because of its poor performance.</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>In the db_driver directory, execute</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>./configure <span class="o">[</span>--with-mysql, --with-oracle, --with-sybase, --with-db2 or --with-informix<span class="o">]</span>
<span class="nv">$ </span>make
<span class="nv">$ </span>sudo make install
</pre></div>

<p>Or you can select your drivers in rebar.conf</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">drivers</span><span class="p">,</span> <span class="p">[</span><span class="n">mysql</span><span class="p">,</span> <span class="n">oracle</span><span class="p">]}.</span>
</pre></div>

<p>and execute</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>./rebar compile
</pre></div>

<h2>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>In the db_driver directory, execute</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>./make_edoc
<span class="nv">$ </span>./rebar doc
</pre></div>

<p>to generate Erlang API.</p>

<p>The Database-Driven Documentation generated by doxygen. If you installed
doxygen, you can execute</p>

<div class="highlight highlight-sh"><pre><span class="nv">$ </span>doxygen priv/doc/db.doxyfile
</pre></div>

<p>to generated <a href="lib/html/index.html">C API</a>.</p>

<p>Open doc/index.html to view the erlang API document.</p>

<h2>
<a name="connection-parameters" class="anchor" href="#connection-parameters"><span class="octicon octicon-link"></span></a>Connection Parameters</h2>

<p>To use db_driver, you need to configure db_driver to make default database
connection for database-driven start-up. The connection parametes likes:</p>

<div class="highlight highlight-erlang"><pre><span class="nv">PoolId</span> <span class="o">=</span> <span class="n">test</span><span class="p">,</span>
<span class="nv">ConnArgs</span> <span class="o">=</span>  <span class="p">[{</span><span class="n">driver</span><span class="p">,</span> <span class="n">mysql</span><span class="p">},</span>
             <span class="p">{</span><span class="n">database</span><span class="p">,</span> <span class="s">"test"</span><span class="p">},</span>
             <span class="p">{</span><span class="n">host</span><span class="p">,</span> <span class="s">"localhost"</span><span class="p">},</span>
             <span class="p">{</span><span class="n">user</span><span class="p">,</span> <span class="s">"root"</span><span class="p">},</span>
             <span class="p">{</span><span class="n">password</span><span class="p">,</span> <span class="s">""</span><span class="p">},</span>
             <span class="p">{</span><span class="n">poolsize</span><span class="p">,</span> <span class="mi">8</span><span class="p">}</span>
             <span class="p">].</span>
</pre></div>

<p>where PoolId is the name of your connection instance, the type is atom.</p>

<p>The following is required parameters.</p>

<div class="highlight highlight-erlang"><pre><span class="nn">driver</span><span class="p">::</span><span class="nf">atom</span><span class="p">()</span>          <span class="nv">Database</span> <span class="n">type</span><span class="p">.</span> <span class="nv">Supported</span> <span class="n">mysql</span><span class="p">,</span> <span class="n">oracle</span> <span class="ow">and</span> <span class="n">sybase</span><span class="p">.</span>
<span class="nn">database</span><span class="p">::</span><span class="nf">string</span><span class="p">()</span>      <span class="nv">Database</span> <span class="n">name</span><span class="p">.</span>
<span class="nn">host</span><span class="p">::</span><span class="nf">string</span><span class="p">()</span>          <span class="nv">Database</span> <span class="n">host</span> <span class="n">name</span> <span class="ow">or</span> <span class="nv">IP</span> <span class="n">address</span><span class="p">.</span>
<span class="nn">user</span><span class="p">:</span><span class="nf">string</span><span class="p">()</span>           <span class="nv">Database</span> <span class="n">user</span><span class="p">.</span>
<span class="nn">password</span><span class="p">:</span><span class="nf">string</span><span class="p">()</span>       <span class="nv">Database</span> <span class="n">password</span><span class="p">.</span>
<span class="nn">poolsize</span><span class="p">::</span><span class="nf">integer</span><span class="p">()</span>     <span class="nv">Connection</span> <span class="n">pool</span> <span class="nb">size</span><span class="p">.</span>
</pre></div>

<p>The following is optional parameters.</p>

<div class="highlight highlight-erlang"><pre><span class="nn">port</span><span class="p">::</span><span class="nf">integer</span><span class="p">()</span>             <span class="c">%% Database port. Default is 3306.</span>
<span class="nn">default_pool</span><span class="p">::</span><span class="nf">boolean</span><span class="p">()</span>     <span class="c">%% Default Connection pool.</span>
<span class="nn">error_handler</span><span class="p">::{</span><span class="nv">Mod</span><span class="p">,</span> <span class="nv">Fun</span><span class="p">}</span>   <span class="c">%% Callback Function of error handler.</span>
</pre></div>

<h2>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h2>

<p>Starts db driver</p>

<div class="highlight highlight-erlang"><pre><span class="c">%% Start db driver.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">start</span><span class="p">().</span>

<span class="c">%% Connection instance Id.</span>
<span class="nv">PoolId</span> <span class="o">=</span> <span class="n">'test'</span><span class="p">.</span>

<span class="c">%% Connection args.</span>
<span class="nv">ConnArg</span> <span class="o">=</span> <span class="p">[{</span><span class="n">driver</span><span class="p">,</span> <span class="n">mysql</span><span class="p">},</span>
           <span class="p">{</span><span class="n">database</span><span class="p">,</span> <span class="s">"test"</span><span class="p">},</span>
           <span class="p">{</span><span class="n">host</span><span class="p">,</span> <span class="s">"localhost"</span><span class="p">},</span>
           <span class="p">{</span><span class="n">user</span><span class="p">,</span> <span class="s">"root"</span><span class="p">},</span>
           <span class="p">{</span><span class="n">password</span><span class="p">,</span> <span class="s">""</span><span class="p">},</span>
           <span class="p">{</span><span class="n">poolsize</span><span class="p">,</span> <span class="mi">8</span><span class="p">},</span>
           <span class="p">{</span><span class="n">default_pool</span><span class="p">,</span> <span class="n">true</span><span class="p">}].</span>

<span class="c">%% Add a connection pool.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">add_pool</span><span class="p">(</span><span class="nv">PoolId</span><span class="p">,</span> <span class="nv">ConnArg</span><span class="p">).</span>

<span class="c">%% Execute sql string.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">execute_sql</span><span class="p">(</span><span class="s">"select version()"</span><span class="p">).</span>

<span class="c">%% If you didn't set the default pool flag, you can execute sql like this.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">execute_sql</span><span class="p">(</span><span class="s">"select version()"</span><span class="p">,</span> <span class="p">[{</span><span class="n">pool</span><span class="p">,</span> <span class="nv">PoolId</span><span class="p">}]).</span>

<span class="c">%% Remove a connecttion pool.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">remove_pool</span><span class="p">(</span><span class="nv">PoolId</span><span class="p">),</span>

<span class="c">%% Stop db driver.</span>
<span class="nn">db_api</span><span class="p">:</span><span class="nf">stop</span><span class="p">().</span>
</pre></div>

<p>If you set the dafault pool flag in several connection pools,
the default pool is the last added pool.</p>

<h2>
<a name="tests" class="anchor" href="#tests"><span class="octicon octicon-link"></span></a>Tests</h2>

<p>See test cases in module basic_SUITE, module informix_SUITE and module oracle_SUITE.</p>

<h2>
<a name="data-type" class="anchor" href="#data-type"><span class="octicon octicon-link"></span></a>Data Type</h2>

<p>The following is the mapping of database data type to Erlang data type.</p>

<h4>
<a name="mysql-data-type" class="anchor" href="#mysql-data-type"><span class="octicon octicon-link"></span></a>MySQL data type.</h4>

<div class="highlight highlight-erlang"><pre><span class="nv">BIT</span>             <span class="n">integer</span><span class="p">()</span>
<span class="nv">TINYINT</span>         <span class="n">integer</span><span class="p">()</span>
<span class="nv">BOOL</span><span class="p">,</span> <span class="nv">BOOLEAN</span>   <span class="n">integer</span><span class="p">()</span>
<span class="nv">SMALLINT</span>        <span class="n">integer</span><span class="p">()</span>
<span class="nv">MEDIUMINT</span>       <span class="n">integer</span><span class="p">()</span>
<span class="nv">INT</span>             <span class="n">integer</span><span class="p">()</span>
<span class="nv">INTEGER</span>         <span class="n">integer</span><span class="p">()</span>
<span class="nv">BIGINT</span>          <span class="n">integer</span><span class="p">()</span>
<span class="nv">FLOAT</span>           <span class="nb">float</span><span class="p">()</span>
<span class="nv">DOUBLE</span>          <span class="nb">float</span><span class="p">()</span>
<span class="nv">FLOAT</span>           <span class="nb">float</span><span class="p">()</span>
<span class="nv">DECIMAL</span>         <span class="nb">float</span><span class="p">()</span>
<span class="nv">DATE</span>            <span class="p">{</span><span class="n">date</span><span class="p">,</span> <span class="p">{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}</span>
<span class="nv">DATETIME</span>        <span class="p">{</span><span class="n">datetime</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TIMESTAMP</span>       <span class="p">{</span><span class="n">datetime</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TIME</span>            <span class="p">{</span><span class="n">time</span><span class="p">,</span> <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}</span>
<span class="nv">YEAR</span>            <span class="n">integer</span><span class="p">()</span>
<span class="nv">CHAR</span>            <span class="n">integer</span><span class="p">()</span>
<span class="nv">VARCHAR</span>         <span class="n">string</span><span class="p">()</span>
<span class="nv">BINARY</span>          <span class="n">string</span><span class="p">()</span>
<span class="nv">VARBINARY</span>       <span class="n">string</span><span class="p">()</span>
<span class="nv">TINYBLOB</span>        <span class="n">binary</span><span class="p">()</span>
<span class="nv">TINYTEXT</span>        <span class="n">string</span><span class="p">()</span>
<span class="nv">BLOB</span>            <span class="n">binary</span><span class="p">()</span>
<span class="nv">TEXT</span>            <span class="n">string</span><span class="p">()</span>
<span class="nv">MEDIUMBLOB</span>      <span class="n">binary</span><span class="p">()</span>
<span class="nv">MEDIUMTEXT</span>      <span class="n">string</span><span class="p">()</span>
<span class="nv">LONGBLOB</span>        <span class="n">binary</span><span class="p">()</span>
<span class="nv">LONGTEXT</span>        <span class="n">string</span><span class="p">()</span>
</pre></div>

<h4>
<a name="oracle-data-type" class="anchor" href="#oracle-data-type"><span class="octicon octicon-link"></span></a>Oracle data type.</h4>

<div class="highlight highlight-erlang"><pre><span class="nv">STRING</span>          <span class="n">string</span><span class="p">()</span>
<span class="nv">NUMBER</span>          <span class="n">number</span><span class="p">()</span>
<span class="nv">DATE</span>            <span class="p">{</span><span class="n">datetime</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TIMESTAMP</span>       <span class="p">{</span><span class="n">timestamp</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Microseconds</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">TimeZoneOffsetInHours</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">TimeZoneOffsetInMinutes</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TIMESTAMP_Z</span>     <span class="p">{</span><span class="n">timestamp</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Microseconds</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">TimeZoneOffsetInHours</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">TimeZoneOffsetInMinutes</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TIMESTAMP_LZ</span>    <span class="p">{</span><span class="n">timestamp</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Microseconds</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">TimeZoneOffsetInHours</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">TimeZoneOffsetInMinutes</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">BINARY</span>          <span class="n">binary</span><span class="p">()</span>
<span class="nv">CLOB</span>            <span class="n">string</span><span class="p">()</span>
<span class="nv">NCLOB</span>           <span class="n">string</span><span class="p">()</span>
<span class="nv">BLOB</span>            <span class="n">binary</span><span class="p">()</span>
<span class="nv">INTERVAL_YM</span>     <span class="p">{</span><span class="n">interval_ym</span><span class="p">,</span> <span class="p">{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">INTERVAL_DS</span>     <span class="p">{</span><span class="n">interval_ds</span><span class="p">,</span>
                    <span class="p">{</span><span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">FractionalSecondComponent</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}</span>
</pre></div>

<h4>
<a name="sybase-data-type" class="anchor" href="#sybase-data-type"><span class="octicon octicon-link"></span></a>Sybase data type.</h4>

<div class="highlight highlight-erlang"><pre><span class="nv">VARBINARY</span>       <span class="n">binary</span><span class="p">()</span>
<span class="nv">BIT</span>             <span class="n">integer</span><span class="p">()</span>
<span class="nv">CHAR</span>            <span class="n">string</span><span class="p">()</span>
<span class="nv">VARCHAR</span>         <span class="n">string</span><span class="p">()</span>
<span class="nv">UNICHAR</span>         <span class="n">list</span><span class="p">()</span>
<span class="nv">UNIVARCHAR</span>      <span class="n">list</span><span class="p">()</span>
<span class="nv">DATE</span>            <span class="p">{</span><span class="n">date</span><span class="p">,</span> <span class="p">{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}</span>
<span class="nv">TIME</span>            <span class="p">{</span><span class="n">time</span><span class="p">,</span>
                    <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                     <span class="nv">Millisecond</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}</span>
<span class="nv">DATETIME</span>        <span class="p">{</span><span class="n">datetime</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Second</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span>
                      <span class="nv">Millisecond</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">SMALLDATETIME</span>   <span class="p">{</span><span class="n">smalldatetime</span><span class="p">,</span>
                    <span class="p">{{</span><span class="nv">Year</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Month</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Day</span><span class="p">::</span><span class="nf">integer</span><span class="p">()},</span>
                     <span class="p">{</span><span class="nv">Hour</span><span class="p">::</span><span class="nf">integer</span><span class="p">(),</span> <span class="nv">Minute</span><span class="p">::</span><span class="nf">integer</span><span class="p">()}}}</span>
<span class="nv">TINYINT</span>         <span class="n">integer</span><span class="p">()</span>
<span class="nv">SMALLINT</span>        <span class="n">integer</span><span class="p">()</span>
<span class="nv">INT</span>             <span class="n">integer</span><span class="p">()</span>
<span class="nv">BIGINT</span>          <span class="n">integer</span><span class="p">()</span>
<span class="nv">DECIMAL</span>         <span class="p">{</span><span class="n">number</span><span class="p">,</span> <span class="n">string</span><span class="p">()}</span>
<span class="nv">NUMERIC</span>         <span class="p">{</span><span class="n">number</span><span class="p">,</span> <span class="n">string</span><span class="p">()}</span>
<span class="nv">FLOAT</span>           <span class="nb">float</span><span class="p">()</span>
<span class="nv">REAL</span>            <span class="nb">float</span><span class="p">()</span>
<span class="nv">MONEY</span>           <span class="p">{</span><span class="n">number</span><span class="p">,</span> <span class="n">string</span><span class="p">()}</span>
<span class="nv">SMALLMONEY</span>      <span class="nb">float</span><span class="p">()</span>
</pre></div>

<h2>
<a name="query-description" class="anchor" href="#query-description"><span class="octicon octicon-link"></span></a>Query Description</h2>

<h3>
<a name="supported-keyword" class="anchor" href="#supported-keyword"><span class="octicon octicon-link"></span></a>Supported Keyword</h3>

<p>The following keywords are supported (mainly used in the select):</p>

<pre><code>table: 'join', 'left, join', 'right, join', 'inner, join'.
fields: 'as', '+', '-', '*', '/', '.', 'function'.
where: 'and', 'or', 'not', 'like', 'between', 'in', '+', '-', '*', '/', '=', '!=', '&gt;', '&gt;=', '&lt;', '&lt;=', '.', 'function'.
extras: 'order', 'asc', 'desc', 'limit', 'group', 'having', 'and', 'or', 'not', 'like', 'between', 'in', '+', '-', '*', '/', '=', '!=', '&gt;', '&gt;=', '&lt;', '&lt;=', '.', 'function'.
</code></pre>

<h3>
<a name="insert-field-type-description" class="anchor" href="#insert-field-type-description"><span class="octicon octicon-link"></span></a>Insert Field Type Description</h3>

<p>insert function description:</p>

<div class="highlight highlight-erlang"><pre><span class="nf">insert</span><span class="p">(</span><span class="nv">Table</span><span class="p">::</span><span class="nf">atom</span><span class="p">(),</span> <span class="p">[{</span><span class="nv">Field</span><span class="p">::</span><span class="nf">atom</span><span class="p">(),</span> <span class="nv">Value</span><span class="p">::</span><span class="nf">term</span><span class="p">()}]).</span>
</pre></div>

<p>Create table test1, "f + Data Types" as the field name, the sample insert statement is as follows:</p>

<div class="highlight highlight-erlang"><pre><span class="nn">db_api</span><span class="p">:</span><span class="nf">insert</span><span class="p">(</span><span class="n">test1</span><span class="p">,</span> <span class="p">[</span>
        <span class="p">{</span><span class="n">fbit</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ftinyint</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fsmallint</span><span class="p">,</span> <span class="mi">200</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fmediunint</span><span class="p">,</span> <span class="mi">1323</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fint</span><span class="p">,</span> <span class="mi">38524</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fbigint</span><span class="p">,</span> <span class="mi">2233434</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ffloat</span><span class="p">,</span> <span class="mi">238954</span><span class="p">.</span><span class="mi">345</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fdouble</span><span class="p">,</span> <span class="mi">335623</span><span class="p">.</span><span class="mi">276212</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fdecimal</span><span class="p">,</span> <span class="mi">45656</span><span class="p">.</span><span class="mi">12</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fdate</span><span class="p">,</span> <span class="p">{</span><span class="n">date</span><span class="p">,</span> <span class="p">{</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">24</span><span class="p">}}},</span>
        <span class="p">{</span><span class="n">fdatetime</span><span class="p">,</span> <span class="p">{</span><span class="n">datetime</span><span class="p">,</span> <span class="p">{{</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">24</span><span class="p">},</span> <span class="p">{</span><span class="mi">11</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">30</span><span class="p">}}}},</span>
        <span class="p">{</span><span class="n">ftimestamp</span><span class="p">,</span> <span class="p">{</span><span class="n">datetime</span><span class="p">,</span> <span class="p">{{</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">}}}},</span>
        <span class="p">{</span><span class="n">ftime</span><span class="p">,</span> <span class="p">{</span><span class="n">time</span><span class="p">,</span> <span class="p">{</span><span class="mi">11</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">22</span><span class="p">}}},</span>
        <span class="p">{</span><span class="n">fyear</span><span class="p">,</span> <span class="mi">2010</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fchar</span><span class="p">,</span> <span class="mi">97</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fvarchar</span><span class="p">,</span> <span class="s">"test varchar"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fbinary</span><span class="p">,</span> <span class="s">"fjdsgjnkdgbdf dfdfg</span><span class="se">\r\n</span><span class="s"> isfdk"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fvarbinary</span><span class="p">,</span> <span class="s">"dkjsor klsjfsdfj"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ftinytext</span><span class="p">,</span> <span class="s">"dsfgd"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ftext</span><span class="p">,</span> <span class="s">";ljkdf"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fmediumtext</span><span class="p">,</span> <span class="s">"dfuyejksf"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">flongtext</span><span class="p">,</span> <span class="s">"indtvdf"</span><span class="p">},</span>
        <span class="p">{</span><span class="n">ftinyblob</span><span class="p">,</span> <span class="o">&lt;&lt;</span><span class="s">"hg"</span><span class="o">&gt;&gt;</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fblob</span><span class="p">,</span> <span class="o">&lt;&lt;</span><span class="mi">34</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">75</span><span class="o">&gt;&gt;</span><span class="p">},</span>
        <span class="p">{</span><span class="n">fmediumblob</span><span class="p">,</span> <span class="o">&lt;&lt;</span><span class="mi">97</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">100</span><span class="o">&gt;&gt;</span><span class="p">},</span>
        <span class="p">{</span><span class="n">flongblob</span><span class="p">,</span> <span class="o">&lt;&lt;</span><span class="s">"sdfidsigyrertkjhejkrgweur3[5940766%^#$^&amp;(;lgf khjfgh"</span><span class="o">&gt;&gt;</span><span class="p">}</span>
<span class="p">]).</span>
</pre></div>

<h3>
<a name="where-clause-syntax-description" class="anchor" href="#where-clause-syntax-description"><span class="octicon octicon-link"></span></a>Where Clause Syntax Description</h3>

<h4>
<a name="comparison-operators" class="anchor" href="#comparison-operators"><span class="octicon octicon-link"></span></a>Comparison Operators</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">field</span><span class="p">,</span> <span class="n">'='</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
<span class="p">{</span><span class="n">field</span><span class="p">,</span> <span class="n">'!='</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
<span class="p">{</span><span class="n">field</span><span class="p">,</span> <span class="n">'&gt;='</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
<span class="p">{</span><span class="n">field</span><span class="p">,</span> <span class="n">'&lt;='</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
</pre></div>

<h4>
<a name="----" class="anchor" href="#----"><span class="octicon octicon-link"></span></a>'+', '-', '*', '/'</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'+'</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}</span>
<span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'-'</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}</span>
<span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'*'</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}</span>
<span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'/'</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}</span>
</pre></div>

<h4>
<a name="and" class="anchor" href="#and"><span class="octicon octicon-link"></span></a>AND</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">'and'</span><span class="p">,</span> <span class="p">[</span><span class="nv">WhereExpr</span><span class="p">]}</span>
</pre></div>

<h4>
<a name="or" class="anchor" href="#or"><span class="octicon octicon-link"></span></a>OR</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr</span><span class="p">,</span> <span class="n">'or'</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
</pre></div>

<h4>
<a name="not" class="anchor" href="#not"><span class="octicon octicon-link"></span></a>NOT</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">'not'</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
</pre></div>

<h4>
<a name="link" class="anchor" href="#link"><span class="octicon octicon-link"></span></a>LINK</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr</span><span class="p">,</span> <span class="n">'like'</span><span class="p">,</span> <span class="nv">WhereExpr</span><span class="p">}</span>
</pre></div>

<h4>
<a name="between" class="anchor" href="#between"><span class="octicon octicon-link"></span></a>BETWEEN</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr</span><span class="p">,</span> <span class="n">'between'</span><span class="p">,</span> <span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}}</span>
</pre></div>

<h4>
<a name="in" class="anchor" href="#in"><span class="octicon octicon-link"></span></a>IN</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'in'</span><span class="p">,</span> <span class="p">[</span><span class="nv">WhereExpr2</span><span class="p">]}</span>
</pre></div>

<h4>
<a name="as" class="anchor" href="#as"><span class="octicon octicon-link"></span></a>AS</h4>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="nv">WhereExpr1</span><span class="p">,</span> <span class="n">'as'</span><span class="p">,</span> <span class="nv">WhereExpr2</span><span class="p">}</span>
</pre></div>

<p>Example:</p>

<div class="highlight highlight-erlang"><pre><span class="nn">db_api</span><span class="p">:</span><span class="nf">select</span><span class="p">(</span><span class="n">test1</span><span class="p">,</span>
    <span class="p">{</span><span class="n">'and'</span><span class="p">,</span> <span class="p">[{</span><span class="n">fint</span><span class="p">,</span> <span class="n">'&gt;'</span><span class="p">,</span> <span class="mi">10</span><span class="p">},</span> <span class="p">{</span><span class="n">fdate</span><span class="p">,</span> <span class="n">'='</span><span class="p">,</span> <span class="p">{</span><span class="n">date</span><span class="p">,</span> <span class="p">{</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">24</span><span class="p">}}}]})</span>
</pre></div>

<h3>
<a name="option-syntax-description" class="anchor" href="#option-syntax-description"><span class="octicon octicon-link"></span></a>Option Syntax Description</h3>

<h4>
<a name="pool" class="anchor" href="#pool"><span class="octicon octicon-link"></span></a>pool</h4>

<p>Database connection pool.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">pool</span><span class="p">,</span> <span class="n">pool_name</span><span class="p">}</span>
</pre></div>

<h4>
<a name="fields" class="anchor" href="#fields"><span class="octicon octicon-link"></span></a>fields</h4>

<p>select list of fields returned.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">fields</span><span class="p">,</span> <span class="p">[</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">]}</span>
</pre></div>

<h4>
<a name="distinct" class="anchor" href="#distinct"><span class="octicon octicon-link"></span></a>distinct</h4>

<p>Mysql syntax similar to the distinct , whether to remove duplicate records. The default is false.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">distinct</span><span class="p">,</span> <span class="n">true</span><span class="p">}</span>
</pre></div>

<h4>
<a name="extras" class="anchor" href="#extras"><span class="octicon octicon-link"></span></a>extras</h4>

<p>Expand list.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">extras</span><span class="p">,</span> <span class="p">[{</span><span class="n">order</span><span class="p">,</span> <span class="n">name</span><span class="p">},</span> <span class="p">{</span><span class="n">limit</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">}]}</span>
</pre></div>

<p><em>order</em></p>

<p>Ordering the results.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">order</span><span class="p">,</span> <span class="nv">Field</span><span class="p">}</span>
<span class="p">{</span><span class="n">order</span><span class="p">,</span> <span class="p">{</span><span class="nv">Field</span><span class="p">,</span> <span class="n">asc</span><span class="p">}}</span>
<span class="p">{</span><span class="n">order</span><span class="p">,</span> <span class="p">{</span><span class="nv">Field</span><span class="p">,</span> <span class="n">desc</span><span class="p">}}</span>
<span class="p">{</span><span class="n">order</span><span class="p">,</span> <span class="p">[{</span><span class="nv">Field1</span><span class="p">,</span> <span class="n">asc</span><span class="p">},</span> <span class="p">{</span><span class="nv">Field2</span><span class="p">,</span> <span class="n">desc</span><span class="p">}]}</span>
</pre></div>

<p><em>limit</em></p>

<p>Limit the number of records.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">limit</span><span class="p">,</span> <span class="mi">10</span><span class="p">}</span>
<span class="p">{</span><span class="n">limit</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">}</span>
</pre></div>

<p><em>group</em></p>

<p>The result set grouping.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">group</span><span class="p">,</span> <span class="n">name</span><span class="p">}</span>
<span class="p">{</span><span class="n">group</span><span class="p">,</span> <span class="p">[</span><span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">]}</span>
</pre></div>

<p><em>having</em></p>

<p>The result set grouping condition.</p>

<div class="highlight highlight-erlang"><pre><span class="p">{</span><span class="n">having</span><span class="p">,</span> <span class="p">{</span><span class="n">fint</span><span class="p">,</span> <span class="n">'&gt;'</span><span class="p">,</span> <span class="mi">5</span><span class="p">}}</span>
</pre></div>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/denglf/erldb-driver/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/denglf/erldb-driver/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/denglf/erldb-driver"></a> is maintained by <a href="https://github.com/denglf">denglf</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>